{% extends 'base.html' %}
{% block content %}
{% load static %}
{% include 'navbar.html' %}
{% load format_currency %}
{% load  widget_form %}
{% load converted_number %}

  <main class="h-full">
    <div class="grid md:grid-cols-5 h-[100%]">
      <aside class="bg-indigo-800 p-10 md:col-span-1 w-full mb-0
        {% if  products|length > 3 %} 
          h-auto  
        {% else %} 
          h-screen
        {% endif %} ">

        <form method="GET">
          <label class="block text-white my-1"> {{ form.category.label}} </label>
          {{ form.category|add_classes:"w-full rounded-md "  }}
          <label class="block text-white my-1"> {{ form.mark.label}} </label>
          {{  form.mark|add_classes:"w-full rounded-md " }}
          <button class="bg-indigo-900 text-white w-full mt-4 p-2 rounded-md font-bold" type="submit">Filter</button>
        </form>

      </aside>
  
      <div class="md:col-span-4 md:w-[90%] mx-auto">

        {% include 'searchbar.html' %}
        {% if products|length > 0 %}

          <ul class="grid md:gap-4 md:grid-cols-2 lg:grid-cols-3 mt-5">

            {% for product in products %}
            <li class="shadow-md p-4 rounded-md mb-6">
              <img class=" md:w-[200px] mx-auto" src={{ product.image_url.url }} alt={{ product.name }}/>
              <div class="flex flex-col justify-center items-center gap-4 mt-4">
                 <p class="text-center text-indigo-800 font-bold mt-2 "> {{ product.name }} </p>
                 <div class="flex w-full ">
                   <a href="{% url 'product:detail_product' product.slug %}" class="bg-indigo-800 text-white p-2 font-bold rounded-lg w-[80%] flex justify-center items-center text-center gap-4">
                     <p class=" text-white text-xl">{{ product.price|currency }}</p>
                     <svg class="w-8 h-8 text-white hover:transition-all hover:scale-125" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="none" viewBox="0 0 24 24">
                       <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 12H5m14 0-4 4m4-4-4-4"/>
                     </svg>
                   </a>

                 </div>
 
              </div>
  
             </li>
            {% endfor %}

          </ul>
          <!-- secction pagination  -->
          <div class="w-full flex justify-center gap-2 items-center  mb-4
          {% if  products|length > 3 %} 
            mt-0
          {% else %} 
            mt-[10rem]
          {% endif %} 
          
          ">
            
            {% if page_obj.has_previous  %}
            <a href="?page={{ page_obj.previous_page_number}}" class="shadow-md p-2 rounded-md bg-slate-200">previous</a>
            {% else %}
            <button disabled class="cursor-not-allowed opacity-50 shadow-md p-2 rounded-md bg-slate-200">previous</button>  
            {% endif %}
            
            {% for page in p.page_range %}

              {% if  page == page_number|to_number %}
                <button disabled class="p-2 rounded-md bg-indigo-800 text-white"> 
                  {{ page }} 
                </button>
              {% else %}
                <a href="?page={{ page }}" 
                  class=" p-2 rounded-md bg-slate-200 shadow-md "> 
                  {{ page }} 
                </a>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <a href="?page={{ page_obj.next_page_number}}" class=" shadow-md p-2 rounded-md bg-slate-200">next</a>
            {% else %}
              <button disabled class="cursor-not-allowed opacity-50 shadow-md p-2 rounded-md bg-slate-200">next</button>  
            {% endif %}

          </div>
          <!-- end secction pagination -->

        <!-- It show if there no products -->
        {% else %}
          <div class="flex justify-center mt-4">
            <p class="text-center font-bold text-2xl">No results</p>
          </div>
        {% endif %}
      </div>
    </div>
  </main>
  <script src="{% static './js/app.js' %}"></script>
{% endblock %}
